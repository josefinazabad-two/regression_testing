unit_tests:
  - name: ut_source_freshness_s10
    description: tbd
    model: source_freshness_s10
    given:
      - input: ref('source_freshness_s05')
        rows:
          - {latest_change: '2024-07-12 01:00:00', warn_if_before: '2024-07-12 00:30:00', error_if_before: '2024-07-12 00:01:00'}
          - {latest_change: '2024-07-12 00:25:00', warn_if_before: '2024-07-12 00:30:00', error_if_before: '2024-07-12 00:01:00'}
          - {latest_change: '2024-07-12 00:00:00', warn_if_before: '2024-07-12 00:30:00', error_if_before: '2024-07-12 00:01:00'}
    expect:
      rows:
        - {test_result: null}
        - {test_result: 'WARN'}
        - {test_result: 'ERROR'}
